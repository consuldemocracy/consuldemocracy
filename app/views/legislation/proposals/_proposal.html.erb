<div id="<%= dom_id(proposal) %>"
     class="proposal clear <%= ("successful" if proposal.total_votes > Proposal.votes_needed_for_success) %>"
     data-type="proposal">
  <div class="panel <%= ("with-image" if proposal.image.present?) %>">
    <% if proposal.total_votes > Proposal.votes_needed_for_success %>
      <div class="icon-successful"></div>
    <% end %>

    <% if proposal.image.present? %>
      <div class="panel-image">
        <%= image_tag proposal.image.variant(:thumb),
                      alt: proposal.image.title.unicode_normalize %>
      </div>
    <% end %>

    <div class="proposal-content">
      <% cache [locale_and_user_status(proposal), "index", proposal, proposal.author] do %>
        <h3><%= link_to proposal.title, legislation_process_proposal_path(proposal.legislation_process_id, proposal) %></h3>
        <%= render Shared::BasicInfoComponent.new(proposal) do %>
          <% if Geozone.any? %>
            <span class="bullet">&nbsp;&bull;&nbsp;</span>
            <span class="geozone">
              <%= link_to geozone_name(proposal), legislation_process_proposals_path(proposal.legislation_process_id, search: geozone_name(proposal)) %>
            </span>
          <% end %>
        <% end %>
        <div class="proposal-description">
          <p><%= proposal.summary %></p>
          <div class="truncate"></div>
        </div>
        <%= render "shared/tags", taggable: proposal, limit: 5 %>
      <% end %>
    </div>

    <div id="<%= dom_id(proposal) %>_votes">
      <%= render Legislation::Proposals::VotesComponent.new(proposal) %>
    </div>
  </div>
</div>
